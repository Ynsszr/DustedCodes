<!--
    Tags: devops github dotnet-core ci-cd
-->

# GitHub Actions for .NET Core NuGet packages

Last weekend I migrated the [Giraffe web framework]() from [AppVeyor]() to [GitHub Actions]().

Here's a quick summary of what I did, how it works and most importantly how you can just copy paste the final workflow yaml and apply it to your own GitHub repo which produces a .NET Core NuGet package!

## The End Goal

Before I started to migrate the Giraffe CI/CD pipeline from AppVeyor to GitHub Actions I set out the following requirements, which I think represent what I would consider a well configured CI/CD pipeline for a mature .NET Core NuGet library:

- Builds should be triggered for all branches and pull requests
- Build with the latest .NET Core SDK
- Build and test on all 3 major OS versions:
    - Linux
    - macOS
    - Windows
- Have each build produce an artifact with an unofficial NuGet package
- Push early versions of upcoming releases to GitHub's NuGet feed (nightly builds)
- Push release versions to GitHub's NuGet feed and the official NuGet feed
- Trigger package releases through GitHub releases
- Use the release tag as the NuGet version for official releases

I will explain each requirement as we go along, so let's get started...

## Creating the ultimate GitHub Action for .NET Core packages

In order to get started with [GitHub Actions]() one has to create a new folder called `.github` inside a project's root folder and then within that folder create another folder called `workflows`.

The `workflows` folder can contain one or many `.yml` files which GitHub will automatically parse and process in order to trigger a CI/CD run. There's no extra settings, toggles or other shenanigans required. If there's a `.yml` file present then GitHub will run the action, otherwise it won't, simple as that.

In my case I want the CI/CD run to start whenever there was a new Git push, pull request or when a new GitHub release has been published:

###### build.yml

```yaml
name: .NET Core
on:
  push:
  pull_request:
  release:
    types:
      - published
```

I left the `push` and `pull_request` properties empty, which means that any Git push or pull request to any branch of that repository will trigger a CI/CD run. If a change breaks a build then it is good to find out about it as soon as possible and I therefore don't see a reason why those runs should be limited to a particular branch. Particularly pull requests are important to build successfully before they can be merged!

